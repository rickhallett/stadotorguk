---
---

<section class="impact-map-section">
  <div class="impact-map-container">
    <h2 class="section-title">Traffic Impact Visualization</h2>
    <p class="section-description">
      See how traffic decisions are affecting our community. Toggle between views to understand the full impact.
    </p>
    
    <div class="map-controls">
      <button type="button" class="toggle-btn active" data-view="satellite">Satellite View</button>
      <button type="button" class="toggle-btn" data-view="height">Height Map</button>
    </div>
    
    <div class="map-wrapper">
      <div class="map-placeholder" id="impact-map">
        <!-- Map content will be loaded here -->
        <div class="map-loading">Loading impact visualization...</div>
      </div>
    </div>
  </div>
</section>

<style>
.impact-map-section {
  padding: calc(var(--grid-unit) * 10) 0;
  background-color: var(--color-surface);
}

.impact-map-container {
  max-width: var(--max-width);
  margin: 0 auto;
  padding: 0 calc(var(--grid-unit) * 3);
}

.section-title {
  font-family: var(--font-heading-primary);
  font-size: 2.5rem;
  text-align: center;
  color: var(--color-accent);
  margin-bottom: calc(var(--grid-unit) * 2);
}

.section-description {
  text-align: center;
  font-size: 1.1rem;
  color: var(--color-text-secondary);
  margin-bottom: calc(var(--grid-unit) * 4);
  max-width: 600px;
  margin-left: auto;
  margin-right: auto;
}

.map-controls {
  display: flex;
  justify-content: center;
  gap: calc(var(--grid-unit) * 2);
  margin-bottom: calc(var(--grid-unit) * 4);
}

.toggle-btn {
  padding: calc(var(--grid-unit) * 1.5) calc(var(--grid-unit) * 3);
  font-family: var(--font-body);
  font-size: 1rem;
  font-weight: 500;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  background-color: transparent;
  color: var(--color-text-secondary);
  border: 2px solid var(--color-border);
  border-radius: 4px;
  cursor: pointer;
  transition: all 0.3s ease;
}

.toggle-btn:hover {
  border-color: var(--color-accent);
  color: var(--color-accent);
}

.toggle-btn.active {
  background-color: var(--color-accent);
  color: white;
  border-color: var(--color-accent);
}

.map-wrapper {
  position: relative;
  width: 100%;
  max-width: 900px;
  margin: 0 auto;
  background-color: var(--color-background);
  border-radius: 8px;
  overflow: hidden;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
}

.map-placeholder {
  position: relative;
  width: 100%;
  height: 500px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
}

.map-loading {
  color: white;
  font-size: 1.2rem;
  font-weight: 500;
}

.map-image {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: none;
}

.map-image.active {
  display: block;
}

@media (max-width: 768px) {
  .map-controls {
    flex-direction: column;
    align-items: center;
  }
  
  .toggle-btn {
    width: 200px;
  }
  
  .map-placeholder {
    height: 300px;
  }
}
</style>

<script>
  function initializeImpactMapToggle() {
    const toggleBtns = document.querySelectorAll('.toggle-btn');
    const mapContainer = document.getElementById('impact-map');
    
    if (!toggleBtns.length || !mapContainer) return;
    
    toggleBtns.forEach(btn => {
      btn.addEventListener('click', () => {
        // Remove active class from all buttons
        toggleBtns.forEach(b => b.classList.remove('active'));
        
        // Add active class to clicked button
        btn.classList.add('active');
        
        // Update map view (placeholder functionality)
        const view = (btn as HTMLElement).dataset.view;
        updateMapView(view);
      });
    });
  }
  
  function updateMapView(view: string | undefined) {
    const mapContainer = document.getElementById('impact-map');
    if (!mapContainer) return;
    
    // For now, just update the placeholder text
    // In production, this would load actual map images or data
    const loadingText = view === 'satellite' 
      ? 'Loading satellite view...' 
      : 'Loading height map...';
    
    mapContainer.innerHTML = `<div class="map-loading">${loadingText}</div>`;
    
    // Simulate loading delay
    setTimeout(() => {
      mapContainer.innerHTML = `
        <div style="color: white; text-align: center; padding: 2rem;">
          <h3 style="margin-bottom: 1rem;">${view === 'satellite' ? 'Satellite View' : 'Height Map'}</h3>
          <p>Map visualization would appear here</p>
          <p style="font-size: 0.9rem; opacity: 0.8; margin-top: 1rem;">
            Connect to data source to display actual impact data
          </p>
        </div>
      `;
    }, 500);
  }
  
  // Initialize on DOM load
  document.addEventListener('DOMContentLoaded', initializeImpactMapToggle);
</script>